001.cpp (21ms):

DFS is used for this problem. To make the searching process easier, we should sort the list "candidate" and remove the duplicates at first. To make the whole efficient (making good use of the cutting condition), we should search from the largest element.
