001.cpp (480ms):

Use DFS. Pay attention to the first operand. Record the previous operand to easily deal with the case of multiplication.
