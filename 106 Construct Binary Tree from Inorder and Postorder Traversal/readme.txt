001.cpp (32ms):

The basic strategy is the same as that in problem 105. The whole time complexity is O(nlog(n)).
