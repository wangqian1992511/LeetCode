001.cpp (16ms):

Solve with DFS.