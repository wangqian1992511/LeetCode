001.cpp (4ms):

Solve recursively with DFS.