001.cpp (4ms):

Backtracking through dfs. Bit manipulation is used for speeding up.