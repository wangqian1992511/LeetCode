001.cpp (4ms):

Judge with DFS.