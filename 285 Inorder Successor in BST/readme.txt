001.cpp (40ms):

If the node p has a right child, then everything is simple. Otherwise, we should find the first ancestor of the node p such that p is in the left sub-tree of this ancestor.
