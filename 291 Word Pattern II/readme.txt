001.cpp (608ms):

Simply perform the DFS.
